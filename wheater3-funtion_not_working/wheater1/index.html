<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
        <script src="js/jquery.ajax.3.5.1.min.js"></script>
        <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="css/swiper.css">
        <link rel="stylesheet" href="css/bootstrap.css">
        <link rel="stylesheet" href="css/weather-icons.css">
        <link rel="stylesheet" href="css/master.css">
        
    </head>
    <body>
    <div class="container-fluid">
        <div class="container" id="weather_info">
            <div class="row main_info ">
                <div class="col-sm-6 text-center">
                    <h1 class="city padding_t100"></h1>
                    <h2 class="today opacity_60"></h2>
                    <div class="climacon"></div>
                    <img class="svg" src="svg/climacon-cloud_drizzle.svg"/>
                    <p class="temp "></p>
                    
                </div>
            </div>
            <div class="row">
                <div class="border opacity_60"></div>
            </div>
            <div class="row sub_info text-center">
                <div class="swiper-container sub_weather_info col-sm-6 col-sm-offset-3">
                    <div class="swiper-wrapper padding_b30">
                        <div class="swiper-slide">
                            <i class="wi wi-sunrise font_s2em padding_t3 padding_b5"></i>
                            <p class="opacity_60 uppercase">sunrise</p>
                            <div class="sunrise font_s1_2em"></div>
                        </div>
                        <div class="swiper-slide">
                            <i class="wi wi-strong-wind font_s2em padding_b5" id="wi-strong-wind"></i>
                            <p class="opacity_60 uppercase">wind</p>
                            <div class="wind font_s1_2em"></div>
                        </div>
                        <div class="swiper-slide">
                            <i class="wi wi-thermometer-exterior font_s2em padding_b5"></i>
                            <p class="opacity_60 uppercase">min</p>
                            <div class="min-theme font_s1_2em"></div>
                        </div>
                        <div class="swiper-slide">
                            <i class="wi wi-sunset font_s2em padding_b5"></i>
                            <p class="opacity_60 uppercase">sunset</p>
                            <div class="sunset font_s1_2em"></div>
                        </div>
                        <div class="swiper-slide">
                            <i class="wi wi-humidity font_s2em padding_b5"></i>
                            <p class="opacity_60 uppercase">humidity</p>
                            <div class="humidity font_s1_2em"></div>
                        </div>
                        <div class="swiper-slide">
                            <i class="wi wi-thermometer font_s2em padding_b5"></i>
                            <p class="opacity_60 uppercase">max</p>
                            <div class="max-theme font_s1_2em"></div>
                        </div>
                    </div>
                    <div class="swiper-pagination font_s1_2em"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        var url="https://api.openweathermap.org/data/2.5/weather?lat=37.5666102&lon=126.9783881&appid=5b025c8ff79f6784133c1fb245c163c4"

        $('weather_info .load_img').show();

        $.getJSON(url, function(data) {
            var sys = data.sys;  // 국가명, 일출/일몰
            var sunrise = sys.sunrise;
            var sun_up = new Date(sunrise*1000);
            var cal=sun_up.toLocaleTimeString();
            var cal_sunrise = cal.substr(2,5);
            //일출
            var sunset = sys.sunset;
            var sun_down = new Date(sunset*1000);
            var cal=sun_down.toLocaleTimeString();
            var cal_sunset = cal.substr(2,5);
            //일몰       
            var wind = data.wind;  
            var wind_1 = wind.speed;
            var cal_wind = Math.floor(wind_1)+"m/s";
            // var windColl=;             //바람
            var city = data.name;               // 도시명
            var re_city= city.replace('Seoul','GIMPO');
            var weather = data.weather;         // 날씨 객체
            var main = data.main;               // 온도 기압 관련 객체
            var wmain = weather[0].main;        // 구름 상태(Cloudiness)
            var w_id = weather[0].id;  
            var w_d_array = 
            {           
                200:"11d",
                201:"11d",
                202:"11d",
                210:"11d",
                211:"11d",
                212:"11d",
                221:"11d",
                230:"11d",
                231:"11d",
                232:"11d",
                300:"09d",
                301:"09d",
                302:"09d",
                310:"09d",
                311:"09d",
                312:"09d",
                313:"09d",
                314:"09d",
                321:"09d",
                500:"10d",
                501:"10d",
                502:"10d",
                503:"10d",
                504:"10d",
                511:"13d",
                520:"09d",
                521:"09d",
                522:"09d",
                531:"09d",
                600:"13d",
                601:"13d",
                602:"13d",
                611:"13d",
                612:"13d",
                615:"13d",
                616:"13d",
                620:"13d",
                621:"13d",
                622:"13d",
                701:"50d",
                711:"50d",
                721:"50d",
                731:"50d",
                741:"50d",
                751:"50d",
                761:"50d",
                762:"50d",
                771:"50d",
                781:"50d",
               
            }
            var w_n_array = 
            {           
                200:"cloud_lightning_moon",
                201:"cloud_lightning_moon",
                202:"cloud_lightning_moon",
                210:"cloud_lightning_moon",
                211:"cloud_lightning_moon",
                212:"cloud_lightning_moon",
                221:"cloud_lightning_moon",
                230:"cloud_lightning_moon",
                231:"cloud_lightning_moon",
                232:"cloud_lightning_moon",
                300:"cloud_drizzle_moon",
                301:"cloud_drizzle_moon",
                302:"cloud_drizzle_moon",
                310:"cloud_drizzle_moon",
                311:"cloud_drizzle_moon",
                312:"cloud_drizzle_moon",
                313:"cloud_drizzle_moon",
                314:"cloud_drizzle_moon",
                321:"cloud_drizzle_moon",
                500:"cloud_rain_moon",
                501:"cloud_rain_moon",
                502:"cloud_rain_moon",
                503:"cloud_rain_moon",
                504:"cloud_rain_moon",
                511:"cloud_hail_moon",
                520:"cloud_rain_alt_moon",
                521:"cloud_rain_alt_moon",
                522:"cloud_rain_alt_moon",
                531:"cloud_rain_alt_moon",
                600:"cloud_snow_moon",
                601:"cloud_snow_alt_moon",
                602:"cloud_snow_alt_moon",
                611:"cloud_hail_alt_moon",
                612:"cloud_hail_alt_moon",
                615:"cloud_hail_alt_moon",
                616:"cloud_hail_alt_moon",
                620:"cloud_snow_moon",
                621:"cloud_snow_moon",
                622:"cloud_snow_alt_moon",
                701:"cloud_fog_moon",
                711:"cloud_fog_alt_moon",
                721:"cloud_fog_moon",
                731:"tornado",
                741:"cloud_fog_moon",
                751:"cloud_fog_alt_moon",
                761:"cloud_fog_alt_moon",
                762:"cloud_fog_alt_moon",
                771:"cloud_fog_alt_moon",
                781:"tornado",
                800:"moon",
                801:"cloud_moon",
                802:"cloud_moon",
                803:"cloud_moon",
                804:"cloud_moon"
            }
                     // 날씨상태 id 코드
            // var svg = w_id
            // var climacon_url = 'svg/'+ svg +'.svg'

            var icon = weather[0].icon;         // 날씨 아이콘 정보
            var country = sys.country;          // 국가명
            var temp = main.temp;               // 현재 온도
            var temp_min = main.temp_min;       // 최저 온도
            var temp_max = main.temp_max;       // 최고 온도
            var humidity = main.humidity + "%";
                   //습도

            var today = new Date();
            var year = today.getFullYear(); 
            var month = today.getMonth() + 1; 
            var date = today.getDate(); 
            var day = today.getDay(); 
            var week = new Array('SUN', 'MON', 'TUE', 'WEN', 'THU', 'FRI', 'SAT');
            var cal_week = week[day];
            var allDay = 'TODAY ' + year + '.' + month + '.' + date +'.' + cal_week ;
            var icon_url = 'https://openweathermap.org/img/w/' + icon;
            var src =  w_d_array.icon;
            


            var nowTimestamp = Math.floor(Date.now() / 1000);
                        var weatherClass = 'wi wi-owm-';
                        weatherClass += (nowTimestamp >= data.sunrise && nowTimestamp <= data.sunset ? 'day' : 'night');
                        weatherClass += ('-' + weather[0].id);

                        $("#weather_info .icon").addClass(weatherClass);
                        $(".climacon").append('<img src="' + src + '" />');
                        $('#weather_info .city').html(re_city);
                        $('#weather_info .w_id').html(wmain);
                        $('#weather_info .min-theme').html(parseInt(temp_min-273.15)+'&deg' );
                        $('#weather_info .max-theme').html(parseInt(temp_max-273.15)+'&deg' );
                        $('#weather_info .temp').html(parseInt(temp-273.15)+'&deg;'+'C');
                        $('#weather_info .load_img').hide();
                        $('#weather_info .today').html(allDay);
                        $('#weather_info .sunrise').html(cal_sunrise);
                        $('#weather_info .sunset').html(cal_sunset);
                        $('#weather_info .wind').html(cal_wind);
                        $('#weather_info .sunset').html(cal_sunset);                   
                        $('#weather_info .humidity').html(humidity);
                       
            
        
        })
        .fail(function(){
            alert("loading error");
        });



        
    </script>
        <script src="js/swiper.js"></script>
        <script src="js/bootstrap.js"></script>
        <script src="js/jquery-3.5.1.min.js"></script>
        <script src="js/master.js"></script>
    </body>
</html>